extends ../../layouts/default

block content
  .container.mt-4
    h1.mb-4 üìù Ch·ªânh s·ª≠a c√¢u h·ªèi TOEIC Part #{question.part}
    
    form(method="POST", action=`/admin/questions/update/${question._id}`, enctype="multipart/form-data")
      .row
        .col-md-6.mb-3
          label.form-label(for="MaCC") M√£ c√¢u h·ªèi:
          input.form-control(type="text", name="MaCC", id="MaCC", value=question.MaCC || "TOEIC", required)
        
        .col-md-3.mb-3
          label.form-label(for="TopicN") Ch·ªß ƒë·ªÅ (TopicN):
          input.form-control(type="number", name="TopicN", id="TopicN", value=question.TopicN, required)
        
        .col-md-3.mb-3
          label.form-label(for="part") Part:
          input.form-control(type="text", id="partDisplay", value=`Part ${question.part}`, readonly)
          input(type="hidden", name="part", value=question.part)

      //- ... (ph·∫ßn c√≤n l·∫°i gi·ªØ nguy√™n theo part c·ªßa c√¢u h·ªèi) ...

      if question.part == 5
        //- Form cho Part 5
        .mb-3
          label.form-label(for="question") C√¢u h·ªèi:
          textarea.form-control(name="question", id="question", rows="3")= question.question || ''
        
        .row
          each option, index in ['A', 'B', 'C', 'D']
            .col-md-3.mb-3
              label.form-label(for=`option${option}`) ƒê√°p √°n #{option}:
              input.form-control(type="text", name=`options[]`, id=`option${option}`, value=question.options && question.options[index] || '')
        
        .mb-3
          label.form-label(for="correctAnswer") ƒê√°p √°n ƒë√∫ng:
          select.form-select(name="correctAnswer", id="correctAnswer")
            each option in ['A', 'B', 'C', 'D']
              option(value=option, selected=question.correctAnswer == option)= option

      else if question.part == 6
        //- Form cho Part 6
        .mb-3
          label.form-label(for="passage") ƒêo·∫°n vƒÉn:
          textarea.form-control(name="passage", id="passage", rows="5")= question.passage || ''
        
        h5.mt-4 C√°c l·ª±a ch·ªçn cho ch·ªó tr·ªëng:
        each blank, index in question.blanks || [{}]
          .card.mb-3
            .card-header Ch·ªó tr·ªëng #{blank.blank || index + 1}
            .card-body
              input(type="hidden", name=`blanks[${index}][blank]`, value=blank.blank || index + 1)
              .row
                each option, optIndex in ['A', 'B', 'C', 'D']
                  .col-md-3.mb-3
                    label.form-label(for=`blank${index}_option${option}`) L·ª±a ch·ªçn #{option}:
                    input.form-control(type="text", name=`blanks[${index}][options][]`, id=`blank${index}_option${option}`, value=blank.options && blank.options[optIndex] || '')
              .mb-3
                label.form-label(for=`blank${index}_correctAnswer`) ƒê√°p √°n ƒë√∫ng:
                select.form-select(name=`blanks[${index}][correctAnswer]`, id=`blank${index}_correctAnswer`)
                  each option in ['A', 'B', 'C', 'D']
                    option(value=option, selected=blank.correctAnswer == option)= option

      else if question.part == 7
        //- Form cho Part 7
        .mb-3
          label.form-label(for="passage") ƒêo·∫°n vƒÉn:
          textarea.form-control(name="passage", id="passage", rows="5")= question.passage || ''
        
        h5.mt-4 C√¢u h·ªèi:
        each q, index in question.questions || [{}]
          .card.mb-3
            .card-header C√¢u h·ªèi #{index + 1}
            .card-body
              .mb-3
                label.form-label(for=`question${index}_text`) N·ªôi dung c√¢u h·ªèi:
                input.form-control(type="text", name=`questions[${index}][question]`, id=`question${index}_text`, value=q.question || '')
              .row
                each option, optIndex in ['A', 'B', 'C', 'D']
                  .col-md-3.mb-3
                    label.form-label(for=`question${index}_option${option}`) L·ª±a ch·ªçn #{option}:
                    input.form-control(type="text", name=`questions[${index}][options][]`, id=`question${index}_option${option}`, value=q.options && q.options[optIndex] || '')
              .mb-3
                label.form-label(for=`question${index}_correctAnswer`) ƒê√°p √°n ƒë√∫ng:
                select.form-select(name=`questions[${index}][correctAnswer]`, id=`question${index}_correctAnswer`)
                  each option in ['A', 'B', 'C', 'D']
                    option(value=option, selected=q.correctAnswer == option)= option

      //- Ph·∫ßn chung
      .mb-3
        label.form-label(for="explanation") Gi·∫£i th√≠ch:
        textarea.form-control(name="explanation", id="explanation", rows="3")= question.explanation || ''

      if question.Img
        .mb-3
          label.form-label ·∫¢nh hi·ªán t·∫°i:
          br
          img(src=question.Img, width="200", class="img-thumbnail mb-2")
          br
          label.form-check-label
            input.form-check-input(type="checkbox", name="removeImage")
            |  X√≥a ·∫£nh n√†y

      .mb-3
        label.form-label(for="image") ·∫¢nh m·ªõi (n·∫øu thay ƒë·ªïi):
        input.form-control(type="file", name="image", id="image")

      .d-flex.justify-content-between.mt-4
        a.btn.btn-outline-secondary(href="/admin/questions") ‚Üê Quay l·∫°i
        button.btn.btn-primary(type="submit") 
          i.fas.fa-save.me-2
          | L∆∞u thay ƒë·ªïi